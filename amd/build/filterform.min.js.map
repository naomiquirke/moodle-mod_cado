{"version":3,"sources":["../src/filterform.js"],"names":["define","init","cadolist","cadoids","Object","entries","dateselects","document","querySelectorAll","forEach","dateselect","addEventListener","updatechoices","coursename","getElementById","cadochoice","firstChild","removeChild","insertAdjacentHTML","selectedIndex","sdate","Date","value","startdate","Math","floor","getTime","edate","enddate","shortname","indexOf","name"],"mappings":"AA2BAA,OAAM,uBAAC,EAAD,CACF,UAAY,CAKR,MAAO,CACHC,IAAI,CAAE,cAAUC,CAAV,CAAoB,IAEhBC,CAAAA,CAAO,CAAGC,MAAM,CAACC,OAAP,CAAeH,CAAf,CAFM,CAGhBI,CAAW,CAAGC,QAAQ,CAACC,gBAAT,CAA0B,0BAA1B,CAHE,CAItBF,CAAW,CAACG,OAAZ,CAAoB,SAAUC,CAAV,CAAsB,CACtCA,CAAU,CAACC,gBAAX,CAA4B,QAA5B,CAAsCC,CAAtC,CACH,CAFD,EAIA,GAAMC,CAAAA,CAAU,CAAGN,QAAQ,CAACO,cAAT,CAAwB,eAAxB,CAAnB,CACAD,CAAU,CAACF,gBAAX,CAA4B,QAA5B,CAAsCC,CAAtC,EACA,GAAMG,CAAAA,CAAU,CAAGR,QAAQ,CAACO,cAAT,CAAwB,WAAxB,CAAnB,CACAF,CAAa,GAGb,QAASA,CAAAA,CAAT,EAAyB,CAErB,MAAOG,CAAU,CAACC,UAAlB,CAA8B,CAC1BD,CAAU,CAACE,WAAX,CAAuBF,CAAU,CAACC,UAAlC,CACH,CACDD,CAAU,CAACG,kBAAX,CAA8B,YAA9B,qCACAH,CAAU,CAACI,aAAX,CAA2B,CAA3B,CANqB,GAOjBC,CAAAA,CAAK,CAAG,GAAIC,CAAAA,IAAJ,CAASd,QAAQ,CAACO,cAAT,CAAwB,0BAAxB,EAAoDQ,KAA7D,CACRf,QAAQ,CAACO,cAAT,CAAwB,2BAAxB,EAAqDQ,KAD7C,CAERf,QAAQ,CAACO,cAAT,CAAwB,yBAAxB,EAAmDQ,KAF3C,CAPS,CAUjBC,CAAS,CAAGC,IAAI,CAACC,KAAL,CAAWL,CAAK,CAACM,OAAN,GAAkB,GAA7B,CAVK,CAWjBC,CAAK,CAAG,GAAIN,CAAAA,IAAJ,CAASd,QAAQ,CAACO,cAAT,CAAwB,wBAAxB,EAAkDQ,KAA3D,CACRf,QAAQ,CAACO,cAAT,CAAwB,yBAAxB,EAAmDQ,KAD3C,CAERf,QAAQ,CAACO,cAAT,CAAwB,uBAAxB,EAAiDQ,KAFzC,CAXS,CAcjBM,CAAO,CAAGJ,IAAI,CAACC,KAAL,CAAWE,CAAK,CAACD,OAAN,GAAkB,GAA7B,CAdO,CAgBrBvB,CAAO,CAACM,OAAR,CAAgB,SAAUa,CAAV,CAAiB,CAC7B,GAAKA,CAAK,CAAC,CAAD,CAAL,CAASC,SAAT,EAAsBA,CAAvB,EACCD,CAAK,CAAC,CAAD,CAAL,CAASC,SAAT,EAAsBK,CADvB,EAEiD,CAAhD,EAAAN,CAAK,CAAC,CAAD,CAAL,CAASO,SAAT,CAAmBC,OAAnB,CAA2BjB,CAAU,CAACS,KAAtC,CAFL,CAEyD,CACrDP,CAAU,CAACG,kBAAX,CAA8B,YAA9B,yBACqBI,CAAK,CAAC,CAAD,CAD1B,aACiCA,CAAK,CAAC,CAAD,CAAL,CAASO,SAD1C,iBAC2DP,CAAK,CAAC,CAAD,CAAL,CAASS,IADpE,cAEH,CACJ,CAPD,CAQH,CAEJ,CAzCE,CA2CV,CAjDC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * Provides interface for users to edit courseflow activity flow on the\n * courseflow mod editing form.\n *\n * @package    mod_courseflow\n * @copyright  2020 Naomi Quirke\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n*/\n\n/**\n * @module mod_cado/filterform\n */\ndefine([],\n    function () {\n        /**\n         * @alias module:mod_cado/filterform\n         */\n\n        return {\n            init: function (cadolist) {\n                // cadolist has records from Cado: id and name; from Course: shortname, fullname, startdate.\n                const cadoids = Object.entries(cadolist);\n                const dateselects = document.querySelectorAll(\"select[id^='id_compare']\");\n                dateselects.forEach(function (dateselect) {\n                    dateselect.addEventListener('change', updatechoices);\n                });\n\n                const coursename = document.getElementById('id_coursename');\n                coursename.addEventListener('change', updatechoices);\n                const cadochoice = document.getElementById('id_cadoid');\n                updatechoices();\n\n                // Changing the content of cadochoice selector.\n                function updatechoices() {\n                    // First remove existing.\n                    while (cadochoice.firstChild) {\n                        cadochoice.removeChild(cadochoice.firstChild);\n                    }\n                    cadochoice.insertAdjacentHTML('afterbegin', `<option value=\"0\">---</option>`);\n                    cadochoice.selectedIndex = 0;\n                    let sdate = new Date(document.getElementById('id_comparestartdate_year').value,\n                        document.getElementById('id_comparestartdate_month').value,\n                        document.getElementById('id_comparestartdate_day').value);\n                    let startdate = Math.floor(sdate.getTime() / 1000);\n                    let edate = new Date(document.getElementById('id_compareenddate_year').value,\n                        document.getElementById('id_compareenddate_month').value,\n                        document.getElementById('id_compareenddate_day').value);\n                    let enddate = Math.floor(edate.getTime() / 1000);\n\n                    cadoids.forEach(function (value) {\n                        if ((value[1].startdate >= startdate) &&\n                            (value[1].startdate <= enddate) &&\n                            (value[1].shortname.indexOf(coursename.value) >= 0)) {\n                            cadochoice.insertAdjacentHTML('afterbegin',\n                                `<option value=${value[0]}>${value[1].shortname} --- ${value[1].name}</option>`);\n                        }\n                    });\n                }\n\n            }\n        };\n    }\n);\n"],"file":"filterform.min.js"}