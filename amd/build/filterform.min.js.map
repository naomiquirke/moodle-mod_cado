{"version":3,"sources":["../src/filterform.js"],"names":["define","init","cadolist","cadoids","Object","entries","JSON","parse","document","querySelector","value","dateselects","querySelectorAll","forEach","dateselect","addEventListener","updatechoices","coursename","getElementById","cadochoice","firstChild","removeChild","insertAdjacentHTML","selectedIndex","sdate","Date","startdate","Math","floor","getTime","edate","enddate","shortname","indexOf","name"],"mappings":"AA2BAA,OAAM,uBAAC,EAAD,CACF,UAAW,CAKP,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAmB,IAEfC,CAAAA,CAAO,CAAGC,MAAM,CAACC,OAAP,CAAeC,IAAI,CAACC,KAAL,CAAWC,QAAQ,CAACC,aAAT,CAAuBP,CAAvB,EAAiCQ,KAA5C,CAAf,CAFK,CAGfC,CAAW,CAAGH,QAAQ,CAACI,gBAAT,CAA0B,0BAA1B,CAHC,CAIrBD,CAAW,CAACE,OAAZ,CAAoB,SAASC,CAAT,CAAqB,CACrCA,CAAU,CAACC,gBAAX,CAA4B,QAA5B,CAAsCC,CAAtC,CACH,CAFD,EAIA,GAAMC,CAAAA,CAAU,CAAGT,QAAQ,CAACU,cAAT,CAAwB,eAAxB,CAAnB,CACAD,CAAU,CAACF,gBAAX,CAA4B,QAA5B,CAAsCC,CAAtC,EACA,GAAMG,CAAAA,CAAU,CAAGX,QAAQ,CAACU,cAAT,CAAwB,WAAxB,CAAnB,CACAF,CAAa,GAGb,QAASA,CAAAA,CAAT,EAAyB,CAErB,MAAOG,CAAU,CAACC,UAAlB,CAA8B,CAC1BD,CAAU,CAACE,WAAX,CAAuBF,CAAU,CAACC,UAAlC,CACH,CACDD,CAAU,CAACG,kBAAX,CAA8B,YAA9B,qCACAH,CAAU,CAACI,aAAX,CAA2B,CAA3B,CANqB,GAOjBC,CAAAA,CAAK,CAAG,GAAIC,CAAAA,IAAJ,CAASjB,QAAQ,CAACU,cAAT,CAAwB,0BAAxB,EAAoDR,KAA7D,CACRF,QAAQ,CAACU,cAAT,CAAwB,2BAAxB,EAAqDR,KAArD,CAA6D,CADrD,CAERF,QAAQ,CAACU,cAAT,CAAwB,yBAAxB,EAAmDR,KAF3C,CAPS,CAUjBgB,CAAS,CAAGC,IAAI,CAACC,KAAL,CAAWJ,CAAK,CAACK,OAAN,GAAkB,GAA7B,CAVK,CAWjBC,CAAK,CAAG,GAAIL,CAAAA,IAAJ,CAASjB,QAAQ,CAACU,cAAT,CAAwB,wBAAxB,EAAkDR,KAA3D,CACRF,QAAQ,CAACU,cAAT,CAAwB,yBAAxB,EAAmDR,KAD3C,CAERF,QAAQ,CAACU,cAAT,CAAwB,uBAAxB,EAAiDR,KAFzC,CAXS,CAcjBqB,CAAO,CAAGJ,IAAI,CAACC,KAAL,CAAWE,CAAK,CAACD,OAAN,GAAkB,GAA7B,CAdO,CAgBrB1B,CAAO,CAACU,OAAR,CAAgB,SAASH,CAAT,CAAgB,CAC5B,GAAKA,CAAK,CAAC,CAAD,CAAL,CAASgB,SAAT,EAAsBA,CAAvB,EACChB,CAAK,CAAC,CAAD,CAAL,CAASgB,SAAT,EAAsBK,CADvB,EAEiD,CAAhD,EAAArB,CAAK,CAAC,CAAD,CAAL,CAASsB,SAAT,CAAmBC,OAAnB,CAA2BhB,CAAU,CAACP,KAAtC,CAFL,CAEyD,CACrDS,CAAU,CAACG,kBAAX,CAA8B,YAA9B,yBACqBZ,CAAK,CAAC,CAAD,CAD1B,aACiCA,CAAK,CAAC,CAAD,CAAL,CAASsB,SAD1C,iBAC2DtB,CAAK,CAAC,CAAD,CAAL,CAASwB,IADpE,cAEH,CACJ,CAPD,CAQH,CAEJ,CAzCE,CA2CV,CAjDC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * Provides interface for users to edit courseflow activity flow on the\n * courseflow mod editing form.\n *\n * @package    mod_courseflow\n * @copyright  2020 Naomi Quirke\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n*/\n\n/**\n * @module mod_cado/filterform\n */\ndefine([],\n    function() {\n        /**\n         * @alias module:mod_cado/filterform\n         */\n\n        return {\n            init: function(cadolist) {\n                // Var cadolist has records from Cado: id and name; from Course: shortname, fullname, startdate.\n                const cadoids = Object.entries(JSON.parse(document.querySelector(cadolist).value));\n                const dateselects = document.querySelectorAll(\"select[id^='id_compare']\");\n                dateselects.forEach(function(dateselect) {\n                    dateselect.addEventListener('change', updatechoices);\n                });\n\n                const coursename = document.getElementById('id_coursename');\n                coursename.addEventListener('change', updatechoices);\n                const cadochoice = document.getElementById('id_cadoid');\n                updatechoices();\n\n                /** Changing the content of cadochoice selector. */\n                function updatechoices() {\n                    // First remove existing.\n                    while (cadochoice.firstChild) {\n                        cadochoice.removeChild(cadochoice.firstChild);\n                    }\n                    cadochoice.insertAdjacentHTML('afterbegin', `<option value=\"0\">---</option>`);\n                    cadochoice.selectedIndex = 0;\n                    let sdate = new Date(document.getElementById('id_comparestartdate_year').value,\n                        document.getElementById('id_comparestartdate_month').value - 1,\n                        document.getElementById('id_comparestartdate_day').value);\n                    let startdate = Math.floor(sdate.getTime() / 1000);\n                    let edate = new Date(document.getElementById('id_compareenddate_year').value,\n                        document.getElementById('id_compareenddate_month').value,\n                        document.getElementById('id_compareenddate_day').value);\n                    let enddate = Math.floor(edate.getTime() / 1000);\n\n                    cadoids.forEach(function(value) {\n                        if ((value[1].startdate >= startdate) &&\n                            (value[1].startdate <= enddate) &&\n                            (value[1].shortname.indexOf(coursename.value) >= 0)) {\n                            cadochoice.insertAdjacentHTML('afterbegin',\n                                `<option value=${value[0]}>${value[1].shortname} --- ${value[1].name}</option>`);\n                        }\n                    });\n                }\n\n            }\n        };\n    }\n);\n"],"file":"filterform.min.js"}