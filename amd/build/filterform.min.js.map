{"version":3,"sources":["../src/filterform.js"],"names":["define","$","init","cadolist","dateselects","document","querySelectorAll","forEach","dateselect","addEventListener","updatechoices","coursename","on","cadochoice","empty","append","prop","sdate","Date","val","startdate","Math","floor","getTime","edate","enddate","each","index","value","shortname","indexOf","name"],"mappings":"AA2BAA,OAAM,uBAAC,CAAC,QAAD,CAAD,CACF,SAAUC,CAAV,CAAa,CAKT,MAAO,CACHC,IAAI,CAAE,cAAUC,CAAV,CAAoB,CAEtB,GAAMC,CAAAA,CAAW,CAAGC,QAAQ,CAACC,gBAAT,CAA0B,0BAA1B,CAApB,CACAF,CAAW,CAACG,OAAZ,CAAoB,SAAUC,CAAV,CAAsB,CACtCA,CAAU,CAACC,gBAAX,CAA4B,QAA5B,CAAsCC,CAAtC,CACH,CAFD,EAIA,GAAMC,CAAAA,CAAU,CAAGV,CAAC,CAAC,gBAAD,CAApB,CACAU,CAAU,CAACC,EAAX,CAAc,QAAd,CAAwB,iBAAMF,CAAAA,CAAa,EAAnB,CAAxB,EACA,GAAMG,CAAAA,CAAU,CAAGZ,CAAC,CAAC,YAAD,CAApB,CACAS,CAAa,GAGb,QAASA,CAAAA,CAAT,EAAyB,CACrBG,CAAU,CAACC,KAAX,GACAD,CAAU,CAACE,MAAX,qCACAF,CAAU,CAACG,IAAX,CAAgB,eAAhB,CAAiC,CAAjC,EAHqB,GAIjBC,CAAAA,CAAK,CAAG,GAAIC,CAAAA,IAAJ,CAASjB,CAAC,CAAC,2BAAD,CAAD,CAA+BkB,GAA/B,EAAT,CACRlB,CAAC,CAAC,4BAAD,CAAD,CAAgCkB,GAAhC,EADQ,CAERlB,CAAC,CAAC,0BAAD,CAAD,CAA8BkB,GAA9B,EAFQ,CAJS,CAOjBC,CAAS,CAAGC,IAAI,CAACC,KAAL,CAAWL,CAAK,CAACM,OAAN,GAAkB,GAA7B,CAPK,CAQjBC,CAAK,CAAG,GAAIN,CAAAA,IAAJ,CAASjB,CAAC,CAAC,yBAAD,CAAD,CAA6BkB,GAA7B,EAAT,CACRlB,CAAC,CAAC,0BAAD,CAAD,CAA8BkB,GAA9B,EADQ,CAERlB,CAAC,CAAC,wBAAD,CAAD,CAA4BkB,GAA5B,EAFQ,CARS,CAWjBM,CAAO,CAAGJ,IAAI,CAACC,KAAL,CAAWE,CAAK,CAACD,OAAN,GAAkB,GAA7B,CAXO,CAYrBtB,CAAC,CAACyB,IAAF,CAAOvB,CAAP,CAAiB,SAAUwB,CAAV,CAAiBC,CAAjB,CAAwB,CACrC,GAAKA,CAAK,CAACR,SAAN,EAAmBA,CAApB,EACCQ,CAAK,CAACR,SAAN,EAAmBK,CADpB,EAE8C,CAA7C,EAAAG,CAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBnB,CAAU,CAACQ,GAAX,EAAxB,CAFL,CAEsD,CAClDN,CAAU,CAACE,MAAX,yBAAmCY,CAAnC,aAA4CC,CAAK,CAACC,SAAlD,iBAAmED,CAAK,CAACG,IAAzE,cACH,CACJ,CAND,CAOH,CAEJ,CAnCE,CAqCV,CA3CC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * Provides interface for users to edit courseflow activity flow on the\n * courseflow mod editing form.\n *\n * @package    mod_courseflow\n * @copyright  2020 Naomi Quirke\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n*/\n\n/**\n * @module mod_cado/filterform\n */\ndefine(['jquery'],\n    function ($) {\n        /**\n         * @alias module:mod_cado/filterform\n         */\n\n        return {\n            init: function (cadolist) {\n                // cadolist has records from Cado: id and name; from Course: shortname, fullname, startdate.\n                const dateselects = document.querySelectorAll(\"select[id^='id_compare']\");\n                dateselects.forEach(function (dateselect) {\n                    dateselect.addEventListener('change', updatechoices);\n                });\n\n                const coursename = $(\"#id_coursename\");\n                coursename.on('change', () => updatechoices());\n                const cadochoice = $(\"#id_cadoid\");\n                updatechoices();\n\n                // Changing the content of cadochoice selector.\n                function updatechoices() {\n                    cadochoice.empty();\n                    cadochoice.append(`<option value=\"0\">---</option>`);\n                    cadochoice.prop('selectedIndex', 0);\n                    let sdate = new Date($(\"#id_comparestartdate_year\").val(),\n                        $(\"#id_comparestartdate_month\").val(),\n                        $(\"#id_comparestartdate_day\").val());\n                    let startdate = Math.floor(sdate.getTime() / 1000);\n                    let edate = new Date($(\"#id_compareenddate_year\").val(),\n                        $(\"#id_compareenddate_month\").val(),\n                        $(\"#id_compareenddate_day\").val());\n                    let enddate = Math.floor(edate.getTime() / 1000);\n                    $.each(cadolist, function (index, value) {\n                        if ((value.startdate >= startdate) &&\n                            (value.startdate <= enddate) &&\n                            (value.shortname.indexOf(coursename.val()) >= 0)) {\n                            cadochoice.append(`<option value=${index}>${value.shortname} --- ${value.name}</option>`);\n                        }\n                    });\n                }\n\n            }\n        };\n    }\n);\n"],"file":"filterform.min.js"}